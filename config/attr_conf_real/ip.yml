entity:
  id: ip
  name: IP address
  key_data_type: string
  auto_create_record: false
attribs:
  # Attributes of IP Activity module
  activity_flows:
    name: Activity (flows)
    description: Number of flows generated by the IP address in a time interval.
    data_type: float
    history: true
    history_params:
      pre_validity: 0
      post_validity: 0
      expire_time: 0
      max_age: 7d

  activity_packets:
    name: Activity (packets)
    description: Number of packets generated by the IP address in a time interval.
    data_type: float
    history: true
    history_params:
      pre_validity: 0
      post_validity: 0
      expire_time: 0
      max_age: 7d

  activity_bytes:
    name: Activity (bytes)
    description: Number of bytes generated by the IP address in a time interval.
    data_type: float
    history: true
    history_params:
      pre_validity: 0
      post_validity: 0
      expire_time: 0
      max_age: 7d

  # Tags from emails from Shodan monitor (value = tag name)
  shodan_monitor:
    name: Shodan tags
    description: Potentially unwanted open service according to alerts from Shodan monitor service.
    data_type: category
    multi_value: true
    confidence: true
    history: true
    history_params:
      pre_validity: 7d
      post_validity: 7d
      max_age: 14d

  open_ports:
    name: Open ports
    description: List of open and actively used ports on the device (obtained by observing traffic on that ports).
    data_type: array<int>  # TODO: rather send as plain integers with multi_value=true
    #multi_value: true
    confidence: true
    history: true
    history_params:
      pre_validity: 8h
      post_validity: 8h
      max_age: 7d

  tags_by_services:
    name: Tags by services
    description: Tags describing the device based its on open ports/services.
    data_type: array<string>  # TODO: rather send as plain integers with multi_value=true
    #multi_value: true
    confidence: true
    history: true
    history_params:
      pre_validity: 8h
      post_validity: 8h
      max_age: 7d

  # DNS hostname
  hostname:
    name: Hostname
    description: Hostname associated with the IP address according to a DNS PTR query.
    data_type: string

  # Flow classification
  in_flow_tags:
    name: Tags describing protocol or traffic type of incoming flows to the device.
    data_type: string
    multi_value: true
    confidence: true
    history: true
    history_params:
      pre_validity: 1h
      post_validity: 1h
      max_age: 7d
      max_items: 200

  out_flow_tags:
    name: Tags describing protocol or traffic type of outgoing flows from the device.
    data_type: string
    multi_value: true
    confidence: true
    history: true
    history_params:
      pre_validity: 1h
      post_validity: 1h
      max_age: 7d
      max_items: 200

  # HTTP User-Agent
  operating_system_ua:
    name: Operating system by HTTP User-Agent
    descripion: Operating system derived from the HTTP User-Agent headers sent by the device.
    data_type: category
    confidence: true
    multi_value: true
    history: true
    history_params:
      pre_validity: 1h
      post_validity: 1h
      max_age: 7d

  hardware_type_ua:
    name: Hardware type by HTTP User-Agent
    descripion: Hardware type (Device type) derived from the HTTP User-Agent headers sent by the device.
    data_type: category
    multi_value: true
    confidence: true
    history: true
    history_params:
      pre_validity: 1h
      post_validity: 1h
      max_age: 7d

  operating_platform_ua:
    name: Operating platform by HTTP User-Agent
    descripion: Operating platform derived from the HTTP User-Agent headers sent by the device.
    data_type: string
    multi_value: true
    confidence: true
    history: true
    history_params:
      pre_validity: 1h
      post_validity: 1h
      max_age: 7d

  software_name_ua:
    name: Software name by HTTP User-Agent
    descripion: Name of the software used by the device (derived from the HTTP User-Agent headers it sent).
    data_type: string
    multi_value: true
    confidence: true
    history: true
    history_params:
      pre_validity: 1h
      post_validity: 1h
      max_age: 7d

  software_type_ua:
    name: Software type by HTTP User-Agent
    descripion: Type of the software used by the device (derived from the HTTP User-Agent headers it sent).
    data_type: category
    multi_value: true
    confidence: true
    history: true
    history_params:
      pre_validity: 1h
      post_validity: 1h
      max_age: 7d

  http_useragent:
    name: HTTP User-Agent used by device
    descripion: Full User-Agent string used in HTTP requests made by the device.
    data_type: string
    multi_value: true
    confidence: true
    history: true
    history_params:
      pre_validity: 1h
      post_validity: 1h
      max_age: 7d

  # Operating System by TCP and IP protocols
  os_by_tcpip:
    name: OS by TCP/IP data
    description: Operating system determined from values of several header fields of TCP and IP protocols
    data_type: category
    # A device usually have just one OS, but not always, and also the information from TCP/IP is just a guess,
    # so it's definitely possible that the module reports different values in the same time interval.
    multi_value: true
    confidence: true
    history: true
    history_params:
      pre_validity: 8h
      post_validity: 8h
      max_age: 14d

  # TLS fingerprinting (JA3cury)
  tls_os_family:
    name: TLS OS family
    description: Family of operating system with its confidence.
    data_type: array<string>
    confidence: true
    history: true
    history_params:
      pre_validity: 8h
      post_validity: 8h
      max_age: 14d

  tls_os_name:
    name: TLS OS name
    description: OS family with OS name. Value of confidence represent probability of OS family multiplied by probability of OS name.
    data_type: array<string>
    confidence: true
    history: true
    history_params:
      pre_validity: 8h
      post_validity: 8h
      max_age: 14d

  tls_os_version:
    name: TLS OS version
    description: OS family, OS name with OS version. Value of confidence represent probability of OS family * probability of OS name * probability of OS version.
    data_type: array<string>
    confidence: true
    history: true
    history_params:
      pre_validity: 8h
      post_validity: 8h
      max_age: 14d

  tls_categories:
    name: TLS OS categories
    description: Categories of network traffic extracted from TLS fingerprint.
    data_type: string
    multi_value: true
    confidence: true
    history: true
    history_params:
      pre_validity: 4h
      post_validity: 4h
      max_age: 14d

  tls_processes:
    name: TLS OS processes
    description: Detected proccesses via TLS fingeprinting.
    data_type: string
    multi_value: true
    confidence: true
    history: true
    history_params:
      pre_validity: 4h
      post_validity: 4h
      max_age: 14d

  # Results of host_classification (hostml) module
  hostml_label:
    name: ML classification
    description: Labels assigned by statistical ML-based host classification
    data_type: category
    multi_value: true
    confidence: true
    history: true
    history_params:
      pre_validity: 8h
      post_validity: 8h
      max_age: 14d


  # Geolocation by public IP address
  geolocation:
    name: Geolocation
    description: "Approximate geographical location according to the IP address and a geolocation database. Format: country (iso_code), city, timezone"
    data_type: string

  # net_descr - from Manual Labels module
  net_descr:
    name: Network name
    description: Name of network prefix accodring to a static configuration (Manual Labels module)
    data_type: string

  # Device type
  device_type:
    name: Device type
    description: Type of device (guessed based on other attributes)
    data_type: category
    # No pre-defined categories for now - let's stay open to ease experiments
    #    categories:
    #      - pc        # Classic desktop computer or notebook
    #      - mobile    # Mobile phone or tablet
    #      - server    # Server - a 24/7 running computer whose main role is to provide one or more services over a network
    #      - netdevice # Router, switch, firewall, etc.
    #      - printer   # Printer
    #      - nas       # Network attached storage (NAS) device
    #      - tv        # Smart TV
    #      - ipcam     # IP camera
    #      - voip      # VoIP device (phone)
    #      - iot       # Other IoT
    # History not stored, since this is derived by a secondary module and we don't know how to store history (create datapoints) in such case, yet

#  shodan_open_ports:
#    name: Shodan - open ports
#    description: List of open ports according to Shodan.io.
#    data_type: int
#    multi_value: true
#    history: true
#    history_params:
#      pre_validity: 24h
#      post_validity: 24h
#      max_age: 14d

  shodan_os:
    name: Shodan - Operating system
    description: Operating system according to Shodan.io.
    data_type: category
    history: true
    history_params:
      pre_validity: 24h
      post_validity: 24h
      max_age: 14d

  shodan_server_sw:
    name: Shodan - server software
    description: Server software running on the spefified port according to Shodan.io.
    data_type: dict<port:int,sw:string>
    multi_value: true
    history: true
    history_params:
      pre_validity: 24h
      post_validity: 24h
      max_age: 14d

  # Label Fusion
  os_evaluations:
    name: OS Evaluations
    description: Evaluations of operating system based on entity's other attributes.
    data_type: json

  os_taxonomic:
    name: OS Taxonomic Classification
    description: Taxonomic classification of operating system based on entity's other attributes.
    data_type: json

  device_evaluations:
    name: Device Evaluations
    description: Evaluations of device type based on entity's other attributes.
    data_type: json

  device_taxonomic:
    name: Device Taxonomic Classification
    description: Taxonomic classification of device type based on entity's other attributes.
    data_type: json

# IP activity classes
  activity_class:
    name: Activity class
    description: Class of the device activity based on the number of transmitted bytes (off, idle, low, medium, high).
    data_type: category
    categories: ["off", "idle", "low", "medium", "high"]

 # ASN of destination IPs
  destination_asns:
    name: Destination ASNs
    description: List of ASNs the IP communicated with
    data_type: set<int>
    history: true
    history_params:
      max_age: 7d

# DNS open resolver
  open_resolver:
    name: DNS open resolver
    description: Open DNS resolver is running on the device
    data_type: tag
